<nav class="navbar">
  <button class="hamburger-btn" (click)="toggleMenu()">
    <span class="menu-icon">≡</span>
  </button>

  <!-- Overlay to close menu when clicking outside -->
  <div class="sidebar-overlay" [class.open]="isMenuOpen" (click)="closeMenu()"></div>

  <div class="nav-links" [class.open]="isMenuOpen">
    <button class="close-btn" (click)="toggleMenu()">✕</button>

    <a routerLink="/index" (click)="isMenuOpen = false">Inicio</a>
    <a [routerLink]="[]" fragment="footer" (click)="isMenuOpen = false">Sobre nosotros</a>
    <a routerLink="/contact" (click)="isMenuOpen = false">Contacto</a>
    <!-- Conditional link: "Únete" for guests, "Mis reservas" for logged-in users -->
    <a *ngIf="!currentUser" routerLink="/signIn" (click)="isMenuOpen = false">Únete</a>
    <a *ngIf="currentUser" routerLink="/profile/orders" (click)="isMenuOpen = false">Mis reservas</a>
  </div>

  <div class="nav-actions">
    <div class="search-box" [class.expanded]="isSearchOpen">
      <input type="text" placeholder="Buscar..." [(ngModel)]="searchText" (keyup.enter)="performSearch()"
        (focus)="showFilterMenu = true" (click)="$event.stopPropagation(); showFilterMenu = true" class="search-input"
        appFocusOnInit>

      <button class="search-submit-btn" (click)="toggleSearch()">
        <img src="/logos/magnifier.svg" alt="Buscar" class="search-icon-svg">
      </button>

      @if (showFilterMenu) {
      <div class="filter-dropdown-container" @fadeInOut (click)="$event.stopPropagation()">

        <app-search-filter (close)="showFilterMenu = false" (apply)="onFilterApplied($event)">
        </app-search-filter>

      </div>
      }

    </div>

    <button class="user-btn" (click)="handleUserClick()" id="user-img-btn">
      <img [src]="userProfileImage" (error)="handleImageError($event)" alt="Usuario" class="user-svg"
        [class.default-icon]="userProfileImage.includes('users.svg')" style="border-radius: 50%;">
    </button>
  </div>

  @if (currentUser && isUserMenuOpen) {
  <app-user-menu (closeMenu)="closeUserMenu()"></app-user-menu>
  }

</nav>